---
layout: default
title: Daily Status - 2026-02-09
date: 2026-02-09
---

# Daily Status - 2026-02-09

## Accomplishments
- Completed provider abstraction refactoring ([MGMT-22880](https://issues.redhat.com/browse/MGMT-22880))
  - Eliminated all provider type switches from controller
  - Added BlockDeletionOnFailure field to CRD for crash-safe deletion policies
  - Created rich result types (ProvisionResult, DeprovisionResult) replacing provider name checking
  - Moved provider-specific logic into provider implementations
  - All 90+ tests passing, zero linter issues
  - Deployed refactored operator: `quay.io/etabak/cloudkit-operator:74ced2e`
- Fixed EDA deletion infinite polling bug
  - Enhanced provider interface to pass resource object to status methods
  - EDA provider now checks AAP finalizer to detect completion
  - Maintains clean abstraction with no controller changes
  - Deployed and validated with end-to-end test: `quay.io/etabak/cloudkit-operator:96423b5`
- Fixed EDA webhook configuration in vmaas-dev environment
  - Corrected ComputeInstance webhook URLs from non-existent `innabox-eda-service:5000` to `innabox-aap-eda-api:8000`
  - Updated latency experiment script with improved provider verification (checks env vars directly)
  - Cleaned up stuck VMs and processes from failed test runs
- Investigated EDA performance improvement
  - Discovered 4.3x speedup in EDA provision time (649s â†’ ~140s)
  - Verified speedup is real through controlled testing with both custom and official upstream operator images
  - Ruled out operator code changes as cause
  - Documented dynamic vs static EDA service architecture
- Pushed commits `74ced2e` and `96423b5` to `tzvatot/cloudkit-operator:feature/aap-provisioning-MGMT-23031`

## Risks & Challenges
- **CRITICAL BUG DISCOVERED:** Concurrent provision and deprovision jobs running simultaneously
  - ComputeInstance `vm-jgkx2` showed provision job (7265) still running while deprovision job (7267) was started
  - Expected behavior: provision job should be cancelled before deprovision starts
  - Potential race condition or silent cancellation failure in AAP provider
  - Investigating root cause in `isReadyForDeprovision()` method
- **Unresolved:** AAP Direct missing ReconciledConfigVersion update when provision succeeds
  - Without this, controller cannot detect spec changes vs already reconciled state
  - Currently works due to workaround (reading annotation set by old EDA playbook)
  - Fix needed in `internal/provisioning/aap_provider.go:178` getJobStatus() method
- **Mystery:** Unknown cause of 4.3x EDA performance improvement between Feb 8-9
  - Likely external infrastructure changes (AAP/EDA/Ansible optimizations)
  - Need to investigate AAP server logs, playbook execution times, or infrastructure changes

## Key Effort
Provider abstraction refactoring to eliminate type switches and achieve clean separation of concerns between controller and provider implementations
