---
layout: default
title: Daily Status - 2026-02-09
date: 2026-02-09
---

# Daily Status - 2026-02-09

## Accomplishments
- Completed provider abstraction refactoring ([MGMT-22880](https://issues.redhat.com/browse/MGMT-22880))
  - Eliminated all provider type switches from controller code
  - Added `BlockDeletionOnFailure` field to CRD for crash-safe deletion policies
  - Created rich result types (`ProvisionResult`, `DeprovisionResult`) to replace provider interface methods
  - Moved provider-specific logic into provider implementations (AAP and EDA)
  - Internalized AAP cancellation logic and EDA finalizer checks into respective providers
  - All 90+ unit tests passing, zero linter issues
  - Deployed refactored operator: `quay.io/etabak/cloudkit-operator:74ced2e`
- Fixed EDA deletion infinite polling bug
  - Root cause: EDA provider's `GetDeprovisionStatus()` always returned `Running` state
  - Solution: Enhanced provider interface to pass resource object to status methods
  - EDA provider now checks AAP finalizer removal to detect completion
  - Maintains clean abstraction - no controller changes needed
  - Deployed fixed operator: `quay.io/etabak/cloudkit-operator:96423b5`
  - Validated with end-to-end test script (`test_compute_instance.sh`)
- Fixed vmaas-dev environment EDA webhook configuration
  - Diagnosed latency experiment failures - EDA tests stuck in "Progressing" state
  - Root cause: Deployment configured with non-existent service URLs (`innabox-eda-service:5000`)
  - Fixed webhook URLs to point to correct service (`innabox-aap-eda-api:8000`)
  - Improved experiment script provider verification to check environment variables directly
  - Cleaned up stuck VMs and experiment processes
  - Environment ready for latency testing

## Risks & Challenges
- AAP Direct missing ReconciledConfigVersion update (CRITICAL)
  - AAP Direct doesn't set `ReconciledConfigVersion` when provision job succeeds
  - Without this, controller can't detect if spec changed vs already reconciled
  - Workaround currently works because `handleReconciledConfigVersion` reads annotation set by old EDA playbook
  - Fix needed: AAP provider `getJobStatus()` must populate `ReconciledVersion` field when successful
  - Location: `internal/provisioning/aap_provider.go:178`
- Need to investigate upstream deployment manifests to fix source of bad webhook URLs

## Key Effort
Provider abstraction refactoring to eliminate type switches and create clean, extensible architecture for adding new provisioning providers.
