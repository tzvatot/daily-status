---
layout: default
title: Daily Status - 2026-02-09
date: 2026-02-09
---

# Daily Status - 2026-02-09

## Accomplishments
- Completed provider abstraction refactoring (eliminated all provider type switches from controller)
  - Added BlockDeletionOnFailure field to CRD
  - Created rich result types (ProvisionResult, DeprovisionResult)
  - Moved provider-specific logic into provider implementations
  - All 90+ tests passing, zero linter issues
- Fixed EDA deletion infinite polling bug
  - Enhanced provider interface to pass resource object to status methods
  - EDA provider now checks finalizer to detect completion
  - Deployed and validated with end-to-end test
- Fixed vmaas-dev environment EDA webhook configuration
  - Corrected webhook URLs to point to correct service (innabox-aap-eda-api:8000)
  - Improved experiment script provider verification (check env vars, not logs)
  - Cleaned up stuck VMs and processes
- Investigated EDA performance improvement
  - Discovered EDA provision time improved from 649s to ~140s (4.3x faster)
  - Verified speedup is real through controlled testing with both custom and official operator images
  - Ruled out operator code changes as cause
  - Corrected understanding of dynamic vs static EDA service architecture
- Created monitoring script for latency experiments (`monitor_experiment.sh` with 5-minute polling)
- Pushed commits to feature branch: `74ced2e` (refactoring), `96423b5` (EDA fix)

## Risks & Challenges
- **CRITICAL BUG DISCOVERED:** Concurrent provision and deprovision jobs running simultaneously
  - ComputeInstance `vm-jgkx2` showing provision job 7265 still running while deprovision job 7267 started
  - Expected behavior: provision job should be cancelled before deprovision starts
  - Possible race condition in AAP provider's `isReadyForDeprovision()` method
  - Impact: Resource conflicts, potential orphaned resources, unreliable deletion flow
- **CRITICAL:** AAP Direct missing ReconciledConfigVersion update (carried forward from 2026-02-08)
  - AAP Direct doesn't set ReconciledConfigVersion when provision job succeeds
  - Controller can't detect if spec changed vs already reconciled without this
  - Fix needed in `internal/provisioning/aap_provider.go:178` getJobStatus() method
- Outstanding mystery: What changed in AAP/EDA infrastructure between Feb 8-9 causing 4.3x speedup

## Key Effort
Provider abstraction refactoring to eliminate controller dependency on provider types while maintaining crash-safe deletion policies and clean separation of concerns.
