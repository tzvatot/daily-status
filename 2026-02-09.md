---
layout: default
title: Daily Status - 2026-02-09
date: 2026-02-09
---

# Daily Status - 2026-02-09

## Accomplishments
- Fixed job state mapping inconsistencies in provisioning providers - added `JobStateWaiting` and `JobStateUnknown` states, fixed AAP status mapping to correctly map "pending" → Pending (was incorrectly Running), added comprehensive unit tests covering all AAP status transitions, updated CRD enum validation, deployed and verified fix with both AAP and EDA providers ([MGMT-22880](https://issues.redhat.com/browse/MGMT-22880))
- Completed provider abstraction refactoring - eliminated all `switch r.ProvisioningProvider.Name()` statements from controller by introducing rich result types (`ProvisionResult`, `DeprovisionResult`) and `BlockDeletionOnFailure` CRD field, moved provider-specific deletion policies into provider implementations, all 90+ tests passing with zero linter issues ([MGMT-22880](https://issues.redhat.com/browse/MGMT-22880))
- Fixed EDA deletion infinite polling bug - added `resource client.Object` parameter to `GetProvisionStatus()` and `GetDeprovisionStatus()` interface methods, EDA provider now checks AAP finalizer state to detect completion, maintains clean abstraction without controller changes, deployed and validated with end-to-end test ([MGMT-22880](https://issues.redhat.com/browse/MGMT-22880))
- Fixed EDA webhook configuration in vmaas-dev environment - updated deployment to use correct service URLs (`innabox-aap-eda-api:8000` instead of non-existent `innabox-eda-service:5000`), improved experiment script provider verification to check environment variables directly, cleaned up stuck VMs and processes ([MGMT-22880](https://issues.redhat.com/browse/MGMT-22880))
- Investigated and documented EDA performance improvement - discovered genuine 4.3x speedup in EDA provision time (649s → ~140s) between Feb 8-9, ruled out operator code changes as cause by testing official upstream image, identified external infrastructure improvements as likely cause, corrected webhook configuration understanding (dynamic `innabox-eda-service:5000` vs static `innabox-aap-eda-api:8000` services) ([MGMT-22880](https://issues.redhat.com/browse/MGMT-22880))
- Created test automation scripts - built `create_ci.sh` for ComputeInstance creation without cleanup, built `delete_ci.sh` for deletion by UUID, both use `--as system:admin` for kubectl operations

## Risks & Challenges
- **BUG DISCOVERED:** Concurrent provision and deprovision jobs - observed ComputeInstance `vm-jgkx2` with provision job still running while deprovision job was started, provision job should have been cancelled before deprovision, investigating race condition in `isReadyForDeprovision()` method
- **CRITICAL ISSUE:** AAP Direct missing ReconciledConfigVersion update - provision success doesn't set this field, breaking spec change detection, currently works via workaround (reads annotation from old EDA playbook), needs fix in `getJobStatus()` to populate ReconciledVersion field
- Test scripts need provider-aware logic - AAP provider expects state transitions (Pending → Running → Succeeded), EDA provider returns Unknown state (no polling support), test validation needs to handle both cases

## Key Effort
Provider abstraction refactoring and fixing job state mapping inconsistencies to eliminate provider-specific logic from controller
