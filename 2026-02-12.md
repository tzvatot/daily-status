---
layout: default
title: Daily Status - 2026-02-12
date: 2026-02-12
---

# Daily Status - 2026-02-12

## Accomplishments

- Implemented status.jobs[] array refactoring across entire codebase (9 commits total)
  - API changes: Added JobType/JobState enums, refactored JobStatus struct, replaced separate fields with jobs array
  - Infrastructure: Added configurable CLOUDKIT_MAX_JOB_HISTORY env var with validation
  - Controller: Added helper functions (FindLatestJobByType, appendJob, updateJob, findJobByID) with full unit test coverage
  - AAP provider: Updated to use jobs array and handle EDA job IDs for provider switch scenarios
  - EDA provider: Implemented unique job ID generation (eda-webhook-N pattern) with comprehensive tests
  - Code quality: Consolidated JobState types, organized into dedicated job_types.go, refactored tests to Ginkgo DescribeTable
  - Bug fixes: Handle Deleting phase when no deprovision job exists, detect EDA job IDs in AAP provider
- Deployed and validated jobs array implementation in vmaas-dev cluster
  - Built and deployed image: quay.io/etabak/cloudkit-operator:beec750
  - Applied updated CRD with jobs array schema
  - All 69 unit tests passing (coverage: 41.5% controller, 66.1% provisioning)
- Completed comprehensive integration testing
  - AAP Direct provider: Jobs 9076 (provision), 9079 (deprovision) with full state tracking (Pending → Running → Succeeded)
  - EDA provider: Jobs eda-webhook-1, eda-webhook-2 with correct incremental IDs
  - Performance testing: 6 parallel VMs (3 per provider), AAP 8.4% faster overall, no jobs array overhead
  - Delete during provision: Validated job cancellation, single deprovision job, no orphaned resources
  - **Provider switch test**: EDA provision → AAP deprovision ([MGMT-23031](https://issues.redhat.com/browse/MGMT-23031))
    - Created ComputeInstance vm-4nl9s with EDA job eda-webhook-1
    - Switched to AAP provider mid-lifecycle
    - AAP successfully created deprovision job 9219 despite EDA provision
    - Jobs array contained both provider types (eda-webhook-1 + 9219)
    - Validated bug fix enabling seamless provider switching
- Updated osac-test-infra for jobs array pattern
  - Converted all kubectl jsonpath queries to jq with type filtering and timestamp sorting
  - Tested successfully with both EDA and AAP providers
  - Committed changes (a4c0262)
  - Fixed shellcheck errors in playbook and roles (commits d78c030, 4fe6989)
- Updated documentation and PR communication
  - Updated [PR #102](https://github.com/osac-project/osac-operator/pull/102) description with comprehensive jobs array implementation details, test results, and breaking changes
  - Migrated AAP provisioning docs to jobs array pattern in [PR #20](https://github.com/osac-project/docs/pull/20)
  - Updated kubectl examples, sequence diagrams (PlantUML), and regenerated PNG images
  - Fixed generate_images.sh for docker/podman compatibility
  - Commit: 778d3e9

## Risks & Challenges

None

## Key Effort

Implemented and validated status.jobs[] array refactoring with mixed-provider lifecycle support (EDA provision → AAP deprovision)
