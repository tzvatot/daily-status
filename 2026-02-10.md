---
layout: default
title: Daily Status - 2026-02-10
date: 2026-02-10
---

# Daily Status - 2026-02-10

## Accomplishments
- Conducted latency comparison experiment between AAP Direct and EDA providers (3 parallel test runs each):
  - EDA showed 12.8% better overall performance (232.0s vs 266.0s total cycle time)
  - AAP provisioned 4.2% faster (150.7s vs 157.3s)
  - EDA deprovisioned 35.3% faster (74.7s vs 115.3s)
  - Results saved to `/tmp/latency_results.csv`

- Created delete-during-provision test infrastructure:
  - New script: `test_delete_during_provision.sh`
  - Playbook: `test_compute_instance_delete_during_provision.yml` with provider-specific validation logic
  - Validates deletion behavior, CR cleanup, and no orphaned VMs

- Fixed critical bug: provision job state not updated in CR status when canceled
  - Root cause: Controller checked AAP API but never wrote state back to CR status
  - Modified `DeprovisionResult` to include provision job state
  - Controller now updates `status.provisionJob.state` during wait phase
  - Deployed fix (image: quay.io/etabak/cloudkit-operator:2953ef1)

- Fixed second bug: provision job state not updated when deprovision triggered
  - Controller only updated state during waiting phase, not when triggering deprovision
  - Modified `TriggerDeprovision` to return state in both cases
  - Controller now updates state for both DeprovisionWaiting and DeprovisionTriggered
  - Deployed fix (image: quay.io/etabak/cloudkit-operator:b429e06)

- Fixed third bug: provision job message field showing stale "running" when state was "Canceled"
  - Changed provider interface to return full `ProvisionStatus` (state + message) instead of just state
  - Controller now updates both `state` and `message` fields atomically
  - Deployed final fix (image: quay.io/etabak/cloudkit-operator:fbebb50)

- Validated complete fix end-to-end:
  - Test run vm-qsfkl: provision job state correctly updated to "Canceled", message to "canceled"
  - All validations passed: no duplicate jobs, CR deleted, no orphaned resources
  - Fixed playbook variable collision causing deprovision validation failures

- Completed full test validation (vm-7wfkv):
  - All 6 validations passed
  - Controller logs confirmed correct state/message updates throughout lifecycle
  - End-to-end delete-during-provision workflow fully validated

## Risks & Challenges
- Intermittent fulfillment API connectivity issues blocked some test runs (no route to host errors)
- Infrastructure instability required multiple test attempts before successful validation

## Key Effort
Fixed provision job status visibility by ensuring controller updates both state and message fields in CR status when canceling jobs, with complete end-to-end validation of delete-during-provision workflow.
